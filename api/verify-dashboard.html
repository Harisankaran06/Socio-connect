<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socio Connect - API Verification Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 15px; 
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 30px; 
            text-align: center; 
        }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .header p { font-size: 1.1rem; opacity: 0.9; }
        .content { padding: 30px; }
        .test-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .test-card { 
            border: 2px solid #e0e0e0; 
            border-radius: 10px; 
            padding: 20px; 
            transition: all 0.3s ease;
        }
        .test-card.success { border-color: #4CAF50; background: #f8fff8; }
        .test-card.error { border-color: #f44336; background: #fff8f8; }
        .test-card.loading { border-color: #ff9800; background: #fff8f0; }
        .test-title { 
            font-size: 1.2rem; 
            font-weight: 600; 
            margin-bottom: 10px; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
        }
        .test-status { 
            padding: 5px 10px; 
            border-radius: 15px; 
            font-size: 0.8rem; 
            font-weight: bold; 
        }
        .status-success { background: #4CAF50; color: white; }
        .status-error { background: #f44336; color: white; }
        .status-loading { background: #ff9800; color: white; }
        .test-details { 
            margin-top: 10px; 
            font-size: 0.9rem; 
            color: #666; 
        }
        .json-response { 
            background: #f5f5f5; 
            padding: 10px; 
            border-radius: 5px; 
            font-family: monospace; 
            font-size: 0.8rem; 
            white-space: pre-wrap; 
            max-height: 200px; 
            overflow-y: auto; 
            margin-top: 10px; 
        }
        .summary { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 20px; 
            border-radius: 10px; 
            text-align: center; 
            margin-top: 20px; 
        }
        .btn { 
            background: #667eea; 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 25px; 
            cursor: pointer; 
            font-size: 1rem; 
            margin: 10px; 
            transition: all 0.3s ease;
        }
        .btn:hover { background: #5a67d8; transform: translateY(-2px); }
        .progress-bar { 
            width: 100%; 
            height: 8px; 
            background: #e0e0e0; 
            border-radius: 4px; 
            overflow: hidden; 
            margin: 20px 0; 
        }
        .progress-fill { 
            height: 100%; 
            background: linear-gradient(90deg, #4CAF50, #45a049); 
            transition: width 0.5s ease; 
        }
        .quick-links { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 15px; 
            margin-top: 20px; 
        }
        .quick-link { 
            display: block; 
            padding: 15px; 
            background: #f8f9fa; 
            border-radius: 8px; 
            text-decoration: none; 
            color: #333; 
            text-align: center; 
            transition: all 0.3s ease;
        }
        .quick-link:hover { background: #e9ecef; transform: translateY(-2px); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ API Verification Dashboard</h1>
            <p>Real-time testing of Socio Connect PHP MySQL API</p>
        </div>
        
        <div class="content">
            <div style="text-align: center; margin-bottom: 20px;">
                <button class="btn" onclick="runAllTests()">üîÑ Run All Tests</button>
                <button class="btn" onclick="runQuickTest()">‚ö° Quick Test</button>
                <button class="btn" onclick="clearResults()">üßπ Clear Results</button>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%;"></div>
            </div>
            
            <div class="test-grid" id="testGrid">
                <!-- Test cards will be generated here -->
            </div>
            
            <div class="summary" id="summary" style="display: none;">
                <h3>üìä Test Summary</h3>
                <div id="summaryContent"></div>
            </div>
            
            <div class="quick-links">
                <a href="/project/desktop/web/api/test.php" class="quick-link" target="_blank">
                    üîß Detailed PHP Test
                </a>
                <a href="/phpmyadmin" class="quick-link" target="_blank">
                    üóÑÔ∏è phpMyAdmin
                </a>
                <a href="/project/desktop/web/api/stats?mc_area=MC1" class="quick-link" target="_blank">
                    üìä Stats API
                </a>
                <a href="/project/desktop/web/api/complaints?mc_area=MC1" class="quick-link" target="_blank">
                    üìã Complaints API
                </a>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '/project/desktop/web/api';
        let testResults = [];
        let currentTest = 0;
        
        const tests = [
            {
                id: 'network',
                title: 'üåê Network Connectivity',
                description: 'Testing localhost accessibility',
                endpoint: '/project/desktop/web/api/test.php',
                method: 'HEAD'
            },
            {
                id: 'database',
                title: 'üóÑÔ∏è Database Connection',
                description: 'Testing MySQL database connectivity',
                endpoint: '/project/desktop/web/api/test.php',
                method: 'GET',
                validator: (response) => response.includes('Database connection successful')
            },
            {
                id: 'stats',
                title: 'üìä Statistics API',
                description: 'Testing complaint statistics endpoint',
                endpoint: '/project/desktop/web/api/stats?mc_area=MC1',
                method: 'GET',
                showResponse: true
            },
            {
                id: 'recent',
                title: 'üïê Recent Complaints',
                description: 'Testing recent complaints endpoint',
                endpoint: '/project/desktop/web/api/recent?mc_area=MC1&limit=5',
                method: 'GET',
                showResponse: true
            },
            {
                id: 'complaints',
                title: 'üìã All Complaints',
                description: 'Testing all complaints endpoint',
                endpoint: '/project/desktop/web/api/complaints?mc_area=MC1',
                method: 'GET',
                showResponse: true
            },
            {
                id: 'categories',
                title: 'üìà Category Stats',
                description: 'Testing category statistics endpoint',
                endpoint: '/project/desktop/web/api/category-stats?mc_area=MC1',
                method: 'GET',
                showResponse: true
            },
            {
                id: 'analytics',
                title: 'üìä Analytics Data',
                description: 'Testing analytics endpoint',
                endpoint: '/project/desktop/web/api/analytics?mc_area=MC1',
                method: 'GET',
                showResponse: true
            }
        ];

        function createTestCard(test) {
            return `
                <div class="test-card loading" id="card-${test.id}">
                    <div class="test-title">
                        ${test.title}
                        <span class="test-status status-loading" id="status-${test.id}">WAITING</span>
                    </div>
                    <div class="test-details">
                        ${test.description}
                        <br><small>Endpoint: ${test.endpoint}</small>
                    </div>
                    <div class="json-response" id="response-${test.id}" style="display: none;"></div>
                </div>
            `;
        }

        function initializeTests() {
            const grid = document.getElementById('testGrid');
            grid.innerHTML = tests.map(test => createTestCard(test)).join('');
        }

        async function runTest(test) {
            const card = document.getElementById(`card-${test.id}`);
            const status = document.getElementById(`status-${test.id}`);
            const response = document.getElementById(`response-${test.id}`);
            
            card.className = 'test-card loading';
            status.textContent = 'TESTING...';
            status.className = 'test-status status-loading';

            try {
                if (test.method === 'HEAD') {
                    const res = await fetch(test.endpoint, { method: 'HEAD' });
                    const success = res.ok;
                    updateTestResult(test.id, success, `HTTP ${res.status}`, null);
                } else {
                    const res = await fetch(test.endpoint);
                    const text = await res.text();
                    
                    let success = res.ok;
                    let data = null;
                    
                    if (test.validator) {
                        success = test.validator(text);
                    } else if (res.headers.get('content-type')?.includes('application/json')) {
                        try {
                            data = JSON.parse(text);
                            success = data.success === true;
                        } catch (e) {
                            success = false;
                        }
                    }
                    
                    updateTestResult(test.id, success, success ? 'SUCCESS' : 'FAILED', test.showResponse ? (data || text) : null);
                }
            } catch (error) {
                updateTestResult(test.id, false, 'ERROR', error.message);
            }
        }

        function updateTestResult(testId, success, message, responseData) {
            const card = document.getElementById(`card-${testId}`);
            const status = document.getElementById(`status-${testId}`);
            const response = document.getElementById(`response-${testId}`);
            
            card.className = `test-card ${success ? 'success' : 'error'}`;
            status.textContent = message;
            status.className = `test-status ${success ? 'status-success' : 'status-error'}`;
            
            if (responseData) {
                response.style.display = 'block';
                if (typeof responseData === 'object') {
                    response.textContent = JSON.stringify(responseData, null, 2);
                } else {
                    response.textContent = responseData.substring(0, 500) + (responseData.length > 500 ? '...' : '');
                }
            }
            
            testResults[testResults.length] = { testId, success, message };
        }

        async function runAllTests() {
            testResults = [];
            currentTest = 0;
            
            document.getElementById('summary').style.display = 'none';
            initializeTests();
            
            for (let i = 0; i < tests.length; i++) {
                currentTest = i + 1;
                updateProgress((currentTest / tests.length) * 100);
                await runTest(tests[i]);
                await new Promise(resolve => setTimeout(resolve, 500)); // Small delay for UX
            }
            
            showSummary();
        }

        async function runQuickTest() {
            testResults = [];
            const quickTests = tests.slice(0, 3); // Run first 3 tests only
            
            document.getElementById('summary').style.display = 'none';
            initializeTests();
            
            for (let i = 0; i < quickTests.length; i++) {
                currentTest = i + 1;
                updateProgress((currentTest / quickTests.length) * 100);
                await runTest(quickTests[i]);
                await new Promise(resolve => setTimeout(resolve, 300));
            }
            
            showSummary();
        }

        function updateProgress(percentage) {
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        function showSummary() {
            const passed = testResults.filter(r => r.success).length;
            const total = testResults.length;
            const percentage = Math.round((passed / total) * 100);
            
            let summaryHTML = `
                <h4>‚úÖ ${passed}/${total} tests passed (${percentage}%)</h4>
            `;
            
            if (percentage === 100) {
                summaryHTML += `
                    <p>üéâ Perfect! Your API is fully functional and ready for React integration.</p>
                    <p>Next: Start your React app and test the MC1 components.</p>
                `;
            } else if (percentage >= 70) {
                summaryHTML += `
                    <p>‚ö†Ô∏è Most tests passed. Review failed tests and fix minor issues.</p>
                `;
            } else {
                summaryHTML += `
                    <p>üö® Multiple issues found. Check XAMPP/WAMP services and database setup.</p>
                `;
            }
            
            document.getElementById('summaryContent').innerHTML = summaryHTML;
            document.getElementById('summary').style.display = 'block';
            updateProgress(100);
        }

        function clearResults() {
            document.getElementById('testGrid').innerHTML = '<p style="text-align: center; color: #666;">Click "Run All Tests" to start verification</p>';
            document.getElementById('summary').style.display = 'none';
            updateProgress(0);
            testResults = [];
        }

        // Initialize on page load
        window.onload = function() {
            clearResults();
        };
    </script>
</body>
</html>